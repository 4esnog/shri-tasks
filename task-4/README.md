# Видеоплеер в духе немого кино — «Киноглушитель»

Для создания немного кино требуется 3 ссылки: на видео, саундтрек и субтитры (в формате .srt).
По нажатию кнопки "Заглушить" создаются элементы `<video>` и `<audio>`, видеоплеер (в виде `<canvas>`) и элементы управления видео, скачивается и парсится файл с субтитрами.

## Саундтрек
Звук, играющий на фоне, является результатом обработки исходной дорожки (элемент `<audio>`) с помощью Web Audio API: 

1. Сигнал от источника идёт на генератор шума и gainNode.
2. Генератор шума (ScriptProcessorNode) сильно искажает входящий сигнал, в результате чего получается постоянно меняющийся шум.
3. gainNode получает на вход чистый звук и шум, и является "ручкой" урпавления громкостью. Сигнал от этого узла идёт на ctx.destination, т.е. на колонки / наушники.
 
## Субтитры

Файл с субтитрами асинхронно скачивается по введённой в форму ссылке, после чего парсится и преобразуется в массив объектов, каждый из которых содержит информацию об отдельных частях субтитров.

В момент, когда нужно показать титры, видео приостанавливается, на `<canvas>` рисуются субтитры на темном фоне. В момент показа субтитров видео можно останавливать и проигрывать дальше.

## Видео

Источник видео -- элемент `<video>`, не отображаемый на странице. Каждый кадр рисуется на невидимый `backCanvas`. Затем на кадр накладвается серое (желтоватое) изображение случайной яркости со свойством `globalCompositeOperation = 'color'`. После этого со свойством `bctx.globalCompositeOperation = 'exclusion'` рисуется видео - эффект зернистости и поцарапанности.

Обработанная картнка (с эффектами ч/б, зернистости и моргания) рисуется на видимый `<canvas>`. После этого случайным образом рисуются царапины.